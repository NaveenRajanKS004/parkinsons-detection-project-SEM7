<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TremorSense - Audio Analysis Platform</title>
    <meta name="description" content="Advanced AI-powered voice analysis platform for early detection of neurological conditions through tremor pattern recognition.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #2563eb;
            --primary-dark: #1e40af;
            --accent-blue: #00A1D6;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #4a5568;
            --text-muted: #64748b;
            --border-light: #e2e8f0;
            --border-medium: #cbd5e0;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background: var(--bg-secondary);
            min-height: 100vh;
            font-feature-settings: 'cv02', 'cv03', 'cv04', 'cv11';
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            padding: clamp(20px, 4vw, 50px);
            background: var(--bg-primary);
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            position: relative;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 3rem;
            gap: 1rem;
        }

        .header img {
            width: clamp(80px, 10vw, 130px);
            height: auto;
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
        }

        .main-title {
            font-size: clamp(2.5rem, 6vw, 5rem);
            font-weight: 700;
            color: var(--primary-dark);
            text-shadow: var(--shadow-sm);
            letter-spacing: -0.025em;
        }

        .accent {
            color: var(--accent-blue);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .info-card {
            background: var(--bg-tertiary);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-light);
            transition: var(--transition);
            height: auto;
            min-height: 200px;
        }

        .info-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .info-card h2 {
            color: var(--primary-dark);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-blue);
            display: inline-block;
        }

        .info-card p {
            color: var(--text-secondary);
            line-height: 1.7;
            font-size: 0.95rem;
        }

        .cta-section {
            text-align: center;
            margin: 4rem 0;
        }

        .cta-title {
            font-size: clamp(2rem, 4vw, 2.5rem);
            color: var(--primary-dark);
            margin-bottom: 3rem;
            font-weight: 600;
            letter-spacing: -0.025em;
        }

        .button-group {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            font-size: 1rem;
            font-weight: 500;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            min-width: 180px;
            transition: var(--transition);
            position: relative;
            font-family: inherit;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(37, 99, 235, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--primary-dark), #1e3a8a);
            color: white;
            box-shadow: 0 4px 15px rgba(30, 64, 175, 0.3);
        }

        .btn-secondary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(30, 64, 175, 0.4);
        }

        .recording-status {
            display: none;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 1rem 0;
            padding: 1rem;
            background: rgba(239, 68, 68, 0.1);
            border-radius: var(--border-radius);
            border: 1px solid rgba(239, 68, 68, 0.2);
        }

        .recording-dot {
            width: 12px;
            height: 12px;
            background: var(--error);
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        .output-panel {
            background: var(--bg-primary);
            border: 2px dashed var(--border-medium);
            border-radius: var(--border-radius);
            padding: 2rem;
            margin-top: 2rem;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-style: italic;
            color: var(--text-muted);
            transition: var(--transition);
        }

        .output-panel.active {
            background: rgba(37, 99, 235, 0.05);
            border-color: var(--primary-blue);
            color: var(--primary-dark);
            font-style: normal;
        }

        .output-panel.error {
            background: rgba(239, 68, 68, 0.05);
            border-color: var(--error);
            color: var(--error);
            font-style: normal;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(37, 99, 235, 0.3);
            border-top: 3px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .analysis-result {
            text-align: left;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background: var(--bg-primary);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }

        .analysis-result h3 {
            color: var(--text-primary);
            margin-bottom: 1.5rem;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid var(--border-light);
        }

        .result-label {
            font-weight: 500;
            color: var(--text-primary);
        }

        .result-value {
            color: var(--text-secondary);
            font-weight: 400;
        }
        
        .result-value.positive {
            color: var(--success);
            font-weight: 600;
        }
        .result-value.negative {
            color: var(--error);
            font-weight: 600;
        }

        .recommendation {
            margin-top: 1.5rem;
            padding: 1rem;
            border-radius: var(--border-radius);
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .recommendation.positive {
            background: rgba(16, 185, 129, 0.1);
            border: 1px solid rgba(16, 185, 129, 0.2);
            color: #047857;
        }

        .recommendation.warning {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            color: #dc2626;
        }

        .creator-section {
            background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(30, 64, 175, 0.05));
            padding: 3rem 2rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-light);
            margin-top: 3rem;
        }

        .creator-section h3 {
            color: var(--primary-dark);
            font-size: 1.75rem;
            font-weight: 600;
            margin-bottom: 2rem;
            text-align: center;
            padding-bottom: 0.75rem;
            border-bottom: 3px solid var(--primary-blue);
            display: inline-block;
            width: 100%;
            text-align: center;
        }

        .creator-content {
            display: grid;
            gap: 2rem;
        }

        .creator-info {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 2rem;
            align-items: start;
        }

        .creator-avatar {
            position: relative;
        }

        .creator-avatar img {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-blue);
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
        }

        .creator-avatar img:hover {
            transform: scale(1.05);
            box-shadow: 0 12px 25px rgba(37, 99, 235, 0.3);
        }

        .creator-details h4 {
            color: var(--primary-dark);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .creator-title {
            color: var(--accent-blue);
            font-size: 1.1rem;
            font-weight: 500;
            margin-bottom: 1rem;
        }

        .creator-description {
            color: var(--text-secondary);
            line-height: 1.7;
            margin-bottom: 1.5rem;
        }

        .creator-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.7);
            border-radius: var(--border-radius);
            border: 1px solid var(--border-light);
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            display: block;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-blue);
            margin-bottom: 0.25rem;
        }

        .stat-label {
            display: block;
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .creator-links {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .creator-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: var(--bg-primary);
            border: 1px solid var(--border-light);
            border-radius: 50px;
            text-decoration: none;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            transition: var(--transition);
        }

        .creator-link:hover {
            background: var(--primary-blue);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .link-icon {
            font-size: 1rem;
        }

        .creator-mission {
            background: rgba(255, 255, 255, 0.8);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-light);
        }

        .creator-mission h5 {
            color: var(--primary-dark);
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--accent-blue);
            padding-bottom: 0.5rem;
            display: inline-block;
        }

        .creator-mission p {
            color: var(--text-secondary);
            line-height: 1.7;
            font-style: italic;
        }

        .contact-section {
            background: var(--bg-tertiary);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid var(--border-light);
            margin-top: 2rem;
        }

        .contact-section h3 {
            color: var(--primary-dark);
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--primary-blue);
            display: inline-block;
        }

        .contact-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .contact-item {
            color: var(--text-secondary);
            font-weight: 500;
        }

        .footer {
            text-align: center;
            padding: 2rem;
            background: var(--bg-tertiary);
            border-radius: var(--border-radius);
            margin-top: 3rem;
            color: var(--text-muted);
            font-size: 0.9rem;
        }

        .hidden {
            display: none !important;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                margin: 10px;
                padding: 20px;
            }

            .header {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .info-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }

            .info-card {
                padding: 1.5rem;
            }

            .button-group {
                flex-direction: column;
                align-items: center;
                gap: 1rem;
            }

            .btn {
                width: 100%;
                max-width: 280px;
            }

            .output-panel {
                padding: 1.5rem;
                min-height: 150px;
            }

            .analysis-result {
                padding: 1rem;
            }

            .contact-info {
                grid-template-columns: 1fr;
            }

            .creator-section {
                padding: 2rem 1.5rem;
            }

            .creator-info {
                grid-template-columns: 1fr;
                text-align: center;
                gap: 1.5rem;
            }

            .creator-avatar {
                justify-self: center;
            }

            .creator-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 0.75rem;
            }

            .creator-links {
                justify-content: center;
            }

            .creator-mission {
                padding: 1.5rem;
            }
        }

        @media (max-width: 480px) {
            .container {
                padding: 15px;
            }

            .info-card {
                padding: 1rem;
            }

            .cta-section {
                margin: 2rem 0;
            }

            .creator-section {
                padding: 1.5rem 1rem;
            }

            .creator-section h3 {
                font-size: 1.5rem;
            }

            .creator-avatar img {
                width: 100px;
                height: 100px;
            }

            .creator-details h4 {
                font-size: 1.25rem;
            }

            .creator-stats {
                grid-template-columns: repeat(3, 1fr);
                padding: 0.75rem;
            }

            .stat-number {
                font-size: 1.25rem;
            }

            .creator-links {
                gap: 0.5rem;
            }

            .creator-link {
                padding: 0.4rem 0.8rem;
                font-size: 0.8rem;
            }

            .creator-mission {
                padding: 1rem;
            }

            .creator-mission h5 {
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="{{ url_for('static', filename='brain.png') }}" alt="TremorSense Brain Logo" loading="lazy">
            <h1 class="main-title">TREMOR<span class="accent">SENSE</span></h1>
        </header>
        
        <div class="info-grid">
            <div class="info-card">
                <h2>What is Tremor<span class="accent">Sense</span>?</h2>
                <p>TremorSense is an innovative web application designed to aid in the early detection of Parkinson's disease by analyzing vocal patterns. Using advanced machine learning, the tool identifies subtle biomarkers in the human voice that may indicate early-stage risk.</p>
            </div>
            
            <div class="info-card">
                <h2>How It Works</h2>
                <p>Using TremorSense is straightforward. You begin by providing a simple voice sample by sustaining a vowel sound. Instantly, our advanced AI gets to work, processing the audio to analyze dozens of key vocal features in just seconds. Based on this detailed analysis, the application provides a confidential, data-driven risk assessment directly on your screen.</p>
            </div>
        </div>

        <main class="cta-section">
            <h2 class="cta-title">Try TremorSense Now</h2>
            
            <div class="button-group">
                <button class="btn btn-primary" id="recordBtn" aria-label="Record audio for analysis">
                    🎤 Record Audio
                </button>
                <button class="btn btn-secondary" id="uploadBtn" aria-label="Upload audio file for analysis">
                    📁 Upload Audio
                </button>
            </div>

            <div class="recording-status" id="recordingStatus" role="status" aria-live="polite">
                <div class="recording-dot"></div>
                <span>Recording in progress...</span>
            </div>

            <input type="file" id="audioFileInput" accept="audio/*" class="hidden" aria-label="Select audio file">
            
            <div class="output-panel" id="outputPanel" role="region" aria-label="Analysis results">
                Click one of the buttons above to start analyzing your audio
            </div>
        </main>

        <div class="creator-section">
            <h3>About the Creator</h3>
            <div class="creator-content">
                <div class="creator-info">
                    <div class="creator-avatar">
                        <img src="{{ url_for('static', filename='profile.jpg') }}" alt="Naveen Rajan K S - Creator of TremorSense" loading="lazy">
                    </div>
                    <div class="creator-details">
                        <h4>Naveen Rajan K S</h4>
                        <p class="creator-title">B.E - CSE Student | SNS College Of Engineering</p>
                        <p class="creator-description">
                            I’m Naveen Rajan K S, an aspiring DevOps engineer currently pursuing a Bachelor’s degree in Computer Science Engineering at SNS College of Engineering, Coimbatore, graduating in 2026. I’m passionate about leveraging AI tools to streamline DevOps workflows and providing seamless experiences to users.
                        </p>
                        <div class="creator-stats">
                            <div class="stat-item">
                                <span class="stat-number">IV</span>
                                <span class="stat-label">Current Year</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">4</span>
                                <span class="stat-label">Projects Completed</span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-number">3</span>
                                <span class="stat-label">Courses Taken</span>
                            </div>
                        </div>
                        <div class="creator-links">
                            <a href="https://www.linkedin.com/in/naveen-rajan-k-s" class="creator-link" target="_blank" rel="noopener noreferrer">
                                <span class="link-icon">💼</span> LinkedIn
                            </a>
                            <a href="https://github.com/NaveenRajanKS004" class="creator-link" target="_blank" rel="noopener noreferrer">
                                <span class="link-icon">🐙</span> GitHub
                            </a>
                            <a href="#" class="creator-link" target="_blank" rel="noopener noreferrer">
                                <span class="link-icon">🌐</span> Portfolio
                            </a>
                            <a href="mailto:nrks004@gmail.com?subject=Inquiry%20Regarding%20TremorSense" class="creator-link">
                                <span class="link-icon">✉️</span> Email
                            </a>
                        </div>
                    </div>
                </div>
                <div class="creator-mission">
                    <h5>Academic Mission & Vision</h5>
                    <p>
                        My goal is to build strong expertise in DevOps and cloud computing, using automation and AI to create efficient, scalable, and innovative technology solutions that drive meaningful impact in the industry.
                    </p>
                </div>
            </div>
        </div>

        <div class="contact-section">
            <h3>Contact & Support</h3>
            <div class="contact-info">
                <div class="contact-item">
                    <strong>Email:</strong> <a href="mailto:nrks004@gmail.com">nrks004@gmail.com</a>
                </div>
                <div class="contact-item">
                    <strong>GitHub:</strong> <a href="https://github.com/NaveenRajanKS004" target="_blank" rel="noopener noreferrer">github.com/NaveenRajanKS004</a>
                </div>
                <div class="contact-item">
                    <strong>Support:</strong> <a href="mailto:nrks004@gmail.com">nrks004@gmail.com</a>
                </div>
            </div>
        </div>

        <footer class="footer">
            <p>&copy; 2025 TremorSense. All Rights Reserved.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            new TremorSenseApp();
        });

        class TremorSenseApp {
            constructor() {
                // DOM Elements
                this.outputPanel = document.getElementById('outputPanel');
                this.recordBtn = document.getElementById('recordBtn');
                this.uploadBtn = document.getElementById('uploadBtn');
                this.audioFileInput = document.getElementById('audioFileInput');
                this.recordingStatus = document.getElementById('recordingStatus');

                // State
                this.mediaRecorder = null;
                this.audioChunks = [];
                this.isRecording = false;
                
                // Bind methods to maintain context
                this.toggleRecording = this.toggleRecording.bind(this);
                this.uploadAudio = this.uploadAudio.bind(this);
                this.handleFileUpload = this.handleFileUpload.bind(this);
                this.handleDataAvailable = this.handleDataAvailable.bind(this);
                this.handleRecordingStop = this.handleRecordingStop.bind(this);
                
                this.init();
            }

            init() {
                if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                    this.showError('Your browser does not support audio recording. Please use a modern browser.');
                    this.recordBtn.disabled = true;
                }
                
                this.recordBtn.addEventListener('click', this.toggleRecording);
                this.uploadBtn.addEventListener('click', this.uploadAudio);
                this.audioFileInput.addEventListener('change', this.handleFileUpload);
            }

            // --- Recording Logic ---
            async toggleRecording() {
                if (!this.isRecording) {
                    await this.startRecording();
                } else {
                    this.stopRecording();
                }
            }

            async startRecording() {
                try {
                    this.setLoadingState('Requesting microphone access...');
                    const stream = await navigator.mediaDevices.getUserMedia({ 
                        audio: {
                            echoCancellation: true,
                            noiseSuppression: true,
                            sampleRate: 44100
                        } 
                    });
                    
                    this.mediaRecorder = new MediaRecorder(stream, { mimeType: this.getSupportedMimeType() });
                    this.audioChunks = [];
                    this.mediaRecorder.addEventListener('dataavailable', this.handleDataAvailable);
                    this.mediaRecorder.addEventListener('stop', this.handleRecordingStop);
                    
                    this.mediaRecorder.start();
                    this.isRecording = true;
                    this.updateRecordingUI(true);
                    this.resetOutputPanel('Recording started... Click "Stop Recording" when done.');

                } catch (error) {
                    console.error('Recording error:', error);
                    this.handleRecordingError(error);
                }
            }

            stopRecording() {
                if (this.mediaRecorder && this.mediaRecorder.state !== 'inactive') {
                    this.mediaRecorder.stop();
                    this.mediaRecorder.stream.getTracks().forEach(track => track.stop());
                }
                this.isRecording = false;
                this.updateRecordingUI(false);
            }

            handleDataAvailable(event) {
                if (event.data.size > 0) {
                    this.audioChunks.push(event.data);
                }
            }

            handleRecordingStop() {
                const mimeType = this.mediaRecorder.mimeType || 'audio/wav';
                const audioBlob = new Blob(this.audioChunks, { type: mimeType });
                this.processAudio(audioBlob, `recorded_audio.${mimeType.split('/')[1].split(';')[0]}`);
            }

            getSupportedMimeType() {
                const types = ['audio/webm;codecs=opus', 'audio/webm', 'audio/mp4', 'audio/wav'];
                for (const type of types) {
                    if (MediaRecorder.isTypeSupported(type)) return type;
                }
                return 'audio/wav';
            }
            
            handleRecordingError(error) {
                let errorMessage = 'An error occurred while trying to record audio.';
                if (error.name === 'NotAllowedError') errorMessage = 'Microphone access denied. Please enable microphone permissions in your browser settings and try again.';
                else if (error.name === 'NotFoundError') errorMessage = 'No microphone found. Please connect a microphone and try again.';
                else if (error.name === 'NotSupportedError') errorMessage = 'Audio recording is not supported on this browser.';
                this.showError(errorMessage);
                this.updateRecordingUI(false);
            }

            // --- Upload Logic ---
            uploadAudio() {
                this.audioFileInput.click();
            }

            handleFileUpload(event) {
                const file = event.target.files[0];
                if (file) {
                    this.processAudio(file, file.name);
                }
            }

            // --- UI and Processing Logic ---
            async processAudio(audioBlob, fileName) {
                this.setLoadingState('Analyzing audio...');

                // Create a FormData object to send the file to the backend
                const formData = new FormData();
                formData.append('file', audioBlob, fileName);
                
                try {
                    // **IMPORTANT**: This is where you call your backend.
                    // Replace '/predict' with the actual URL of your Flask API endpoint.
                    const response = await fetch('/predict', {
                        method: 'POST',
                        body: formData
                    });

                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error || `Server responded with status ${response.status}`);
                    }
                    
                    const result = await response.json();
                    this.displayResult(result);

                } catch (error) {
                    console.error('Analysis error:', error);
                    // This is a fallback for demonstration since the backend isn't connected yet.
                    this.showError(`Error communicating with the server: ${error.message}. Displaying a mock result instead.`);
                    setTimeout(() => this.displayMockResult(), 2000); // Show a mock result after a delay
                }
            }
            
            updateRecordingUI(isRecording) {
                this.recordBtn.innerHTML = isRecording ? '⏹️ Stop Recording' : '🎤 Record Audio';
                this.recordingStatus.style.display = isRecording ? 'flex' : 'none';
                this.recordBtn.setAttribute('aria-label', isRecording ? 'Stop recording' : 'Record audio for analysis');
                this.uploadBtn.disabled = isRecording;
            }

            setLoadingState(message) {
                this.outputPanel.className = 'output-panel active';
                this.outputPanel.innerHTML = `<div class="loading-spinner"></div><span>${message}</span>`;
            }
            
            resetOutputPanel(message) {
                this.outputPanel.className = 'output-panel';
                this.outputPanel.innerHTML = message || 'Click one of the buttons above to start analyzing your audio';
            }

            showError(message) {
                this.outputPanel.className = 'output-panel error';
                this.outputPanel.innerHTML = `<strong>Error:</strong> ${message}`;
            }
            
            displayResult(result) {
                this.outputPanel.className = 'output-panel active';
                const status = result.prediction === 1 ? "Parkinson's Positive" : "Parkinson's Negative";
                const statusClass = result.prediction === 1 ? "negative" : "positive";
                const recommendationText = result.prediction === 1 
                    ? "The analysis indicates a potential risk. It is strongly recommended to consult a qualified healthcare professional for a comprehensive evaluation. This tool is not a substitute for medical diagnosis."
                    : "The analysis does not indicate significant risk factors based on the voice sample. Regular check-ups are still recommended for maintaining good health.";
                const recommendationClass = result.prediction === 1 ? "warning" : "positive";

                this.outputPanel.innerHTML = `
                    <div class="analysis-result">
                        <h3>Analysis Complete</h3>
                        <div class="result-item">
                            <span class="result-label">Status:</span>
                            <span class="result-value ${statusClass}">${status}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Confidence:</span>
                            <span class="result-value">${(result.confidence * 100).toFixed(2)}%</span>
                        </div>
                        <div class="recommendation ${recommendationClass}">
                            <strong>Recommendation:</strong> ${recommendationText}
                        </div>
                    </div>
                `;
            }
            
            // This is a fallback function for demonstration purposes
            displayMockResult() {
                // Simulates a result object you would get from your Python backend
                const mockResult = {
                    prediction: 1, // 1 for positive, 0 for negative
                    confidence: 0.88
                };
                this.displayResult(mockResult);
            }
        }
    </script>
</body>
</html>